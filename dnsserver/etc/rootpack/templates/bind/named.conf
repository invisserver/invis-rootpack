# Copyright (c) 2001-2004 SuSE Linux AG, Nuernberg, Germany.
# All rights reserved.
#
# Author: Frank Bodammer, Lars Mueller <lmuelle@suse.de>
#
# /etc/named.conf
#
# This is a sample configuration file for the name server BIND 9.  It works as
# a caching only name server without modification.
#
# A sample configuration for setting up your own domain can be found in
# /usr/share/doc/packages/bind/sample-config.
#
# A description of all available options can be found in
# /usr/share/doc/packages/bind/misc/options.

# ACL-Dateien einbinden
include "/etc/named.d/named.blackhole";
include "/etc/named.d/named.whitelist";
include "/etc/named.d/named.secondaries";

options {

	# The directory statement defines the name server's working directory

	directory "/var/lib/named";

	# Write dump and statistics file to the log subdirectory.  The
	# pathenames are relative to the chroot jail.

	dump-file "/var/log/named_dump.db";
	statistics-file "/var/log/named.stats";

	# The forwarders record contains a list of servers to which queries
	# should be forwarded.  Enable this line and modify the IP address to
	# your provider's name server.  Up to three servers may be listed.

	#forwarders { 9.9.9.9; 1.1.1.1; };

	# Enable the next entry to prefer usage of the name server declared in
	# the forwarders section.

	#forward first;

	# The listen-on record contains a list of local network interfaces to
	# listen on.  Optionally the port can be specified.  Default is to
	# listen on all interfaces found on your system.  The default port is
	# 53.

	#listen-on port 53 { 127.0.0.1; };

	# The listen-on-v6 record enables or disables listening on IPv6
	# interfaces.  Allowed values are 'any' and 'none' or a list of
	# addresses.

	listen-on-v6 { any; };

	# The next three statements may be needed if a firewall stands between
	# the local server and the internet.

	#query-source address * port 53;
	#transfer-source * port 53;
	#notify-source * port 53;

	# The allow-query record contains a list of networks or IP addresses
	# to accept and deny queries from. The default is to allow queries
	# from all hosts.

	# recursion limitieren
	# bei Bedarf vertrauenswuerdig Adressen einfuegen
	allow-recursion { whitelist; 127.0.0.0/8; ::1; };
	# schwarzes Loch - nur, wenns gar nicht anders geht
	#blackhole { blackhole; };
	# bei Bedarf vertrauenswuerdig Adressen einfuegen
	allow-query { whitelist; 127.0.0.0/8; ::1; };
	# bei Bedarf vertrauenswuerdig Adressen einfuegen
	allow-query-cache { whitelist; 127.0.0.0/8; ::1; };
	
	# If notify is set to yes (default), notify messages are sent to other
	# name servers when the the zone data is changed.  Instead of setting
	# a global 'notify' statement in the 'options' section, a separate
	# 'notify' can be added to each zone definition.
	## temporaer auf no gesetzt.
	notify yes;
	
	# Zonentransfers nur fuer die bekannten Secondary Nameserver erlauben.
	allow-transfer { secondaries; };

	rate-limit {
    		responses-per-second 5;
    		window 25;
	};
	
	# Rekursion verbieten
	#recursion no;
	
	# DNSSEC aktivieren
	dnssec-enable yes;
	dnssec-validation yes;

};

trusted-keys {
	# DNSSEC Key Root-Zone
	. 257 3 8 "AwEAAaz/tAm8yTn4Mfeh5eyI96WSVexTBAvkMgJzkKTOiW1vkIbzxeF3
                +/4RgWOq7HrxRixHlFlExOLAJr5emLvN7SWXgnLh4+B5xQlNVz8Og8kv
                ArMtNROxVQuCaSnIDdD5LKyWbRd2n9WGe2R8PzgCmr3EgVLrjyBxWezF
                0jLHwVN8efS3rCj/EWgvIWgb9tarpVUDK/b58Da+sqqls3eNbuv7pr+e
                oZG+SrDK6nWeL3c6H5Apxz7LjVc1uTIdsIXxuOLYA4/ilBmSVIzuDWfd
                RUfhHdY6+cn8HFRm+2hM8AnXGXws9555KrUB5qihylGa8subX2Nn6UwN
                R1AkUTV74bU=";
};

# To configure named's logging remove the leading '#' characters of the
# following examples.
logging {
	# Log queries to a file limited to a size of 100 MB.
	channel query_logging {
		file "/var/log/named_querylog"
			versions 3 size 100M;
		print-time yes;			// timestamp log entries
	};
	category queries {
		query_logging;
	};

	# Or log this kind alternatively to syslog.
	#channel syslog_queries {
	#	syslog user;
	#	severity info;
	#};
	#category queries { syslog_queries; };

	# Log general name server errors to syslog.
	channel syslog_errors {
		syslog user;
		severity error;
	};
	category default { syslog_errors;  };

	# Don't log lame server messages.
	category lame-servers { null; };
};

# The following zone definitions don't need any modification.  The first one
# is the definition of the root name servers.  The second one defines
# localhost while the third defines the reverse lookup for localhost.

zone "." in {
	type hint;
	file "root.hint";
};

zone "localhost" in {
	type master;
	file "localhost.zone";
};

zone "0.0.127.in-addr.arpa" in {
	type master;
	file "127.0.0.zone";
};

# Include the meta include file generated by createNamedConfInclude.  This
# includes all files as configured in NAMED_CONF_INCLUDE_FILES from
# /etc/sysconfig/named

include "/etc/named.conf.include";

# You can insert further zone records for your own domains below or create
# single files in /etc/named.d/ and add the file names to
# NAMED_CONF_INCLUDE_FILES.
# See /usr/share/doc/packages/bind/README.SUSE for more details.

## Stefan Schaefer <stefan@invis-server.org>
# named.keys fuer DDNS Schluessel einbinden
include "/etc/named.keys";

## FÃ¼r Zonen dieses Nameservers wurde ein gesondertes Verzeichnis angelegt:
# /etc/named.d/zones
# Alle auf .conf endenden Dateien in diesem Verzeichnis werden beim Start des 
# Nameservers automatisch geladen.
# Damit bleibt die Konfiguration unabhaengig von vorhandenen openSUSE-Automatismen.

include "/etc/named.zones.include";
